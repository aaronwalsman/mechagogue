Epoch: 0
Traceback (most recent call last):
  File "/n/home13/chloe00/miniforge3/envs/eco/lib/python3.12/site-packages/jax/_src/lax/lax.py", line 149, in broadcast_shapes
    return _broadcast_shapes_cached(*shapes)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/n/home13/chloe00/miniforge3/envs/eco/lib/python3.12/site-packages/jax/_src/util.py", line 302, in wrapper
    return cached(config.trace_context() if trace_context_in_key else _ignore(),
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/n/home13/chloe00/miniforge3/envs/eco/lib/python3.12/site-packages/jax/_src/util.py", line 296, in cached
    return f(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^
  File "/n/home13/chloe00/miniforge3/envs/eco/lib/python3.12/site-packages/jax/_src/lax/lax.py", line 155, in _broadcast_shapes_cached
    return _broadcast_shapes_uncached(*shapes)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/n/home13/chloe00/miniforge3/envs/eco/lib/python3.12/site-packages/jax/_src/lax/lax.py", line 171, in _broadcast_shapes_uncached
    raise ValueError(f"Incompatible shapes for broadcasting: shapes={list(shapes)}")
ValueError: Incompatible shapes for broadcasting: shapes=[(49, 49, 256), (256, 1)]

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/n/holylfs06/LABS/sham_lab/Users/chloe00/mechagogue/mechagogue/examples/maxnist/train_mutable_maxnist_ga.py", line 233, in <module>
    model_state, fitness = train_model(train_key, train_x, train_y, model_state)
                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/n/holylfs06/LABS/sham_lab/Users/chloe00/mechagogue/mechagogue/sup/ga.py", line 131, in train
    model_state, fitness = jax.lax.scan(
                           ^^^^^^^^^^^^^
  File "/n/holylfs06/LABS/sham_lab/Users/chloe00/mechagogue/mechagogue/sup/ga.py", line 115, in train_batch
    child_state = breed(breed_keys, parent_state)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/n/holylfs06/LABS/sham_lab/Users/chloe00/mechagogue/mechagogue/arg_wrappers.py", line 26, in wrapped_function
    return function(**wrapped_args)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/n/holylfs06/LABS/sham_lab/Users/chloe00/mechagogue/mechagogue/examples/maxnist/train_mutable_maxnist_ga.py", line 129, in mutate
    mlp_state = mutate_mlp(key, mlp_state)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/n/holylfs06/LABS/sham_lab/Users/chloe00/dirt/dirt/models/mutable_model.py", line 249, in mutate
    weight, bias = mutate_mutable_linear(
                   ^^^^^^^^^^^^^^^^^^^^^^
  File "/n/holylfs06/LABS/sham_lab/Users/chloe00/dirt/dirt/models/mutable_model.py", line 188, in mutate_mutable_linear
    weight_var = weight_var * in_mask[:,:,None] * out_mask # [:,,:]
                 ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^~~~~~~~~~
  File "/n/home13/chloe00/miniforge3/envs/eco/lib/python3.12/site-packages/jax/_src/numpy/array_methods.py", line 1050, in op
    return getattr(self.aval, f"_{name}")(self, *args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/n/home13/chloe00/miniforge3/envs/eco/lib/python3.12/site-packages/jax/_src/numpy/array_methods.py", line 573, in deferring_binary_op
    return binary_op(*args)
           ^^^^^^^^^^^^^^^^
  File "/n/home13/chloe00/miniforge3/envs/eco/lib/python3.12/site-packages/jax/_src/numpy/ufunc_api.py", line 177, in __call__
    return call(*args)
           ^^^^^^^^^^^
  File "/n/home13/chloe00/miniforge3/envs/eco/lib/python3.12/site-packages/jax/_src/numpy/ufuncs.py", line 1186, in _multiply
    x, y = promote_args("multiply", x, y)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/n/home13/chloe00/miniforge3/envs/eco/lib/python3.12/site-packages/jax/_src/numpy/util.py", line 362, in promote_args
    return promote_shapes(fun_name, *promote_dtypes(*args))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/n/home13/chloe00/miniforge3/envs/eco/lib/python3.12/site-packages/jax/_src/numpy/util.py", line 227, in promote_shapes
    result_rank = len(lax.broadcast_shapes(*shapes))
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
ValueError: Incompatible shapes for broadcasting: shapes=[(49, 49, 256), (256, 1)]
--------------------
For simplicity, JAX has removed its internal frames from the traceback of the following exception. Set JAX_TRACEBACK_FILTERING=off to include these.
